# Dog Breed Classifier

This project utilized the Lightweight FastAPI app that serves a ResNet50 model fine-tuned on five breeds (Saint Bernard, Scottish Deerhound, Siberian Husky, Silky Terrier, and Yorkshire Terrier). Upload an image through the bundled web UI—or hit the REST endpoint directly—to receive ranked breed probabilities generated by the PyTorch model stored in `dog_breed_resnet50.pth`.

## Features
- FastAPI backend with a `/predict` endpoint that accepts any RGB image and returns probability-ranked breeds
- Minimal static frontend (`static/index.html`) for drag-and-drop uploads and instant visualization of predictions
- ResNet50 backbone with a custom classification head trained on the curated dataset in `data_split/`
- CPU/GPU aware inference; automatically uses CUDA when available, otherwise falls back to CPU

## Project Layout
- `app.py` – FastAPI application that exposes the HTML frontend and `/predict` route
- `model_inference.py` – Loads the trained model, normalizes incoming images, and performs inference
- `static/` – Self-contained single-page interface for uploading a dog photo and seeing predictions
- `data_split/` – Train/val/test folders (five breeds) used while training; handy for quick experiments
- `DOG.ipynb` – End-to-end notebook outlining data prep, training, and evaluation steps
- `dog_breed_resnet50.pth` – Serialized PyTorch checkpoint with model weights and the `class_names` list

## Getting Started
Requirements:
- Python 3.10+
- A virtual environment (recommended)
- `pip` capable of installing the packages listed in `requirements.txt`

```bash
python3 -m venv .venv
source .venv/bin/activate
pip install --upgrade pip
pip install -r requirements.txt
```

## Running the App
1. Make sure `dog_breed_resnet50.pth` sits next to `model_inference.py` (already true in this repo).
2. Start the API server:
   ```bash
   uvicorn app:app --reload
   ```
3. Navigate to `http://127.0.0.1:8000/` to load the included UI, drop an image of a dog, and review the ranked predictions.

### Calling the API Directly
```bash
curl -X POST \
     -F "file=@/path/to/dog.jpg" \
     http://127.0.0.1:8000/predict
```
Response format:
```json
{
  "predictions": [
    { "breed": "siberian_husky", "probability": 86.52 },
    { "breed": "saint_bernard", "probability": 9.71 },
    ...
  ]
}
```
Probabilities are percentages that sum to ~100.

## Model Notes
- Architecture: ResNet50 backbone from `torchvision` with a two-layer fully connected head (`Linear → ReLU → Dropout → Linear`).
- Input pipeline: Resize to 256 px, center-crop to 224 px, convert to tensor, normalize with ImageNet statistics (see `model_inference.py`).
- Checkpoint contents: `model_state_dict` and `class_names`, so you can reload the mapping without hardcoding labels.

## (Re)Training Tips
The notebook `DOG.ipynb` demonstrates how the current weights were produced. To adapt the classifier:
1. Replace `Mini_Dog_Breed_Data/` (or update `data_split/`) with your own dog images.
2. Re-run the notebook or mirror its logic inside a script, saving the resulting checkpoint as `dog_breed_resnet50.pth`.
3. Restart the API—`model_inference.py` loads the latest checkpoint at import time.

## Further improvement
- Extend the dataset with additional breeds for broader coverage. but be ware of the data imbalances
- Log predictions to disk (or a database) to capture usage metrics.
- Containerize the app for easy deployment to services such as Fly.io, Railway, or Render.
